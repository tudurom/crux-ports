# Description: Voice chat application (client only!)
# URL:         http://mumble.sourceforge.net
# Maintainer:  Tudor Roman, tudurom at gmail dot com
# Depends on:  boost qt4 speex libsndfile protobuf

name=mumble-client
version=1.2.16
release=1
source=(https://github.com/mumble-voip/mumble/archive/$version.tar.gz)

build() {
	cd mumble-$version

	qmake main.pro \
	    CONFIG+=no-bundled-speex \
	    CONFIG+=no-dbus \
	    CONFIG+=no-embed-qt-translations \
	    CONFIG+=no-speechd \
	    CONFIG+=no-bonjour \
	    CONFIG+=no-g15 \
	    CONFIG+=no-11x \
	    CONFIG+=no-server \
            DEFINES+="PLUGIN_PATH=/usr/lib/mumble"

	make release

	install -d $PKG/usr/{bin,lib}
	install -o root -g root release/mumble $PKG/usr/bin/mumble

	install -m755 -o root -g root -D release/plugins/liblink.so $PKG/usr/lib/mumble/liblink.so
	install -m755 -o root -g root -D release/plugins/libmanual.so $PKG/usr/lib/mumble/libmanual.so
	install -o root -g root release/libcelt0.so.0.7.0 $PKG/usr/lib/mumble
	cd $PKG/usr/lib/mumble
	ln -s libcelt0.so.0.7.0 libcelt0.so.0.7
	ln -s libcelt0.so.0.7.0 libcelt0.so.0
	ln -s libcelt0.so.0.7.0 libcelt0.so
}
